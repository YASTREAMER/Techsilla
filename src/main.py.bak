import LLM
from audio import Recording

import gc
import torch


def main():
    # Recording()
    choice = input(
        "Enter the number for the category \n 1) Software dev \n 2) Machine learning \n 3) Web Developement"
    )

    if choice == 1:
        category = "Software dev"
    elif choice == 2:
        category = "Machine learning"
    elif choice == 3:
        category = "Web Developement"
    else:
        print("Invalid choice")
        return

    result = AudioToText()
    corrector = pipeline(
        "text2text-generation", model="prithivida/grammar_error_correcter_v1"
    )
    print(result["text"])
    corrected, score = grammar_score(result["text"], corrector)

    print("Grammar Accuracy Score:", score, "%")
    modelDel(corrector)

    model_name = "Qwen/Qwen3-0.6B"
    # load the tokenizer and the model
    tokenizer = AutoTokenizer.from_pretrained(model_name)
    model = AutoModelForCausalLM.from_pretrained(
        model_name, dtype="auto", device_map="auto"
    )

    Questions = LLM.QuestionGeneration(model, tokenizer, result["text"])
    print(Questions[0])
    sleep(10)
    Recording()
    result = AudioToText()
    LLM.QuestionAnswer(
        model=model, tokenizer=tokenizer, Answer=result["text"], Category=category
    )


if __name__ == "__main__":
    main()
